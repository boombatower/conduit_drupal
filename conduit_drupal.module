<?php
/**
 * @file
 * Provides common Conduit Drupal code.
 *
 * @author Jimmy Berry ("boombatower", http://drupal.org/user/214218)
 */

/**
 * Implements hook_conduit_validate().
 */
function conduit_drupal_conduit_validate(array $properties) {
  extract($properties);
  if ($version < 6 || $version > 8) {
    conduit_validate_error('version', t('must be 6, 7, or 8'));
  }
}

/**
 * Implements hook_conduit_default_properties().
 */
function conduit_drupal_conduit_default_properties() {
  return array(
    'version' => 7,
  );
}

/**
 * Implements hook_views_field_add_multi_join_alter().
 */
function conduit_drupal_views_field_add_multi_join_alter($join, $base_field, $join_field) {
  if ($join_field == 'conduit_result_drupal_summary') {
    if ($base_field == 'conduit_result_drupal_delta') {
      $join['left_field'][3] = 'conduit_result_drupal_delta_value';
      $join['type'] = 'LEFT';
    }
    else {
      $base_field = 'conduit_result_drupal_delta';
    }
  }
}
